var Fudge;
(function (Fudge) {
    let CONTEXTMENU;
    (function (CONTEXTMENU) {
        // SKETCH = ViewSketch,
        CONTEXTMENU[CONTEXTMENU["ADD_NODE"] = 0] = "ADD_NODE";
        CONTEXTMENU[CONTEXTMENU["ACTIVATE_NODE"] = 1] = "ACTIVATE_NODE";
        CONTEXTMENU[CONTEXTMENU["DELETE_NODE"] = 2] = "DELETE_NODE";
        CONTEXTMENU[CONTEXTMENU["ADD_COMPONENT"] = 3] = "ADD_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["DELETE_COMPONENT"] = 4] = "DELETE_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["ADD_COMPONENT_SCRIPT"] = 5] = "ADD_COMPONENT_SCRIPT";
        CONTEXTMENU[CONTEXTMENU["EDIT"] = 6] = "EDIT";
        CONTEXTMENU[CONTEXTMENU["CREATE_FOLDER"] = 7] = "CREATE_FOLDER";
        CONTEXTMENU[CONTEXTMENU["CREATE_MESH"] = 8] = "CREATE_MESH";
        CONTEXTMENU[CONTEXTMENU["CREATE_MATERIAL"] = 9] = "CREATE_MATERIAL";
        CONTEXTMENU[CONTEXTMENU["CREATE_GRAPH"] = 10] = "CREATE_GRAPH";
        CONTEXTMENU[CONTEXTMENU["CREATE_ANIMATION"] = 11] = "CREATE_ANIMATION";
        CONTEXTMENU[CONTEXTMENU["CREATE_PARTICLE_EFFECT"] = 12] = "CREATE_PARTICLE_EFFECT";
        CONTEXTMENU[CONTEXTMENU["SYNC_INSTANCES"] = 13] = "SYNC_INSTANCES";
        CONTEXTMENU[CONTEXTMENU["REMOVE_COMPONENT"] = 14] = "REMOVE_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["ADD_JOINT"] = 15] = "ADD_JOINT";
        CONTEXTMENU[CONTEXTMENU["DELETE_RESOURCE"] = 16] = "DELETE_RESOURCE";
        CONTEXTMENU[CONTEXTMENU["CLONE_RESOURCE"] = 17] = "CLONE_RESOURCE";
        CONTEXTMENU[CONTEXTMENU["ORTHGRAPHIC_CAMERA"] = 18] = "ORTHGRAPHIC_CAMERA";
        CONTEXTMENU[CONTEXTMENU["RENDER_CONTINUOUSLY"] = 19] = "RENDER_CONTINUOUSLY";
        CONTEXTMENU[CONTEXTMENU["SELECTION_OUTLINE"] = 20] = "SELECTION_OUTLINE";
        CONTEXTMENU[CONTEXTMENU["ADD_PROPERTY"] = 21] = "ADD_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["DELETE_PROPERTY"] = 22] = "DELETE_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["CONVERT_ANIMATION"] = 23] = "CONVERT_ANIMATION";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_PROPERTY"] = 24] = "ADD_PARTICLE_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_FUNCTION"] = 25] = "ADD_PARTICLE_FUNCTION";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_CONSTANT"] = 26] = "ADD_PARTICLE_CONSTANT";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_CODE"] = 27] = "ADD_PARTICLE_CODE";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_TRANSFORMATION"] = 28] = "ADD_PARTICLE_TRANSFORMATION";
        CONTEXTMENU[CONTEXTMENU["DELETE_PARTICLE_DATA"] = 29] = "DELETE_PARTICLE_DATA";
    })(CONTEXTMENU = Fudge.CONTEXTMENU || (Fudge.CONTEXTMENU = {}));
    let MENU;
    (function (MENU) {
        MENU["QUIT"] = "quit";
        MENU["PROJECT_NEW"] = "projectNew";
        MENU["PROJECT_SAVE"] = "projectSave";
        MENU["PROJECT_LOAD"] = "projectLoad";
        MENU["DEVTOOLS_OPEN"] = "devtoolsOpen";
        MENU["PANEL_GRAPH_OPEN"] = "panelGraphOpen";
        MENU["PANEL_ANIMATION_OPEN"] = "panelAnimationOpen";
        MENU["PANEL_PROJECT_OPEN"] = "panelProjectOpen";
        MENU["PANEL_HELP_OPEN"] = "panelHelpOpen";
        MENU["PANEL_PARTICLE_SYSTEM_OPEN"] = "panelParticleSystemOpen";
        MENU["FULLSCREEN"] = "fullscreen";
    })(MENU = Fudge.MENU || (Fudge.MENU = {}));
    let PANEL;
    (function (PANEL) {
        PANEL["GRAPH"] = "PanelGraph";
        PANEL["PROJECT"] = "PanelProject";
        PANEL["HELP"] = "PanelHelp";
        PANEL["ANIMATION"] = "PanelAnimation";
        PANEL["PARTICLE_SYSTEM"] = "PanelParticleSystem";
    })(PANEL = Fudge.PANEL || (Fudge.PANEL = {}));
    let VIEW;
    (function (VIEW) {
        VIEW["HIERARCHY"] = "ViewHierarchy";
        VIEW["ANIMATION"] = "ViewAnimation";
        VIEW["ANIMATION_SHEET"] = "ViewAnimationSheet";
        VIEW["RENDER"] = "ViewRender";
        VIEW["COMPONENTS"] = "ViewComponents";
        VIEW["CAMERA"] = "ViewCamera";
        VIEW["INTERNAL_TABLE"] = "ViewInternalTable";
        VIEW["INTERNAL_FOLDER"] = "ViewInternalFolder";
        VIEW["EXTERNAL"] = "ViewExternal";
        VIEW["PROPERTIES"] = "ViewProperties";
        VIEW["PREVIEW"] = "ViewPreview";
        VIEW["SCRIPT"] = "ViewScript";
        VIEW["PARTICLE_SYSTEM"] = "ViewParticleSystem";
        // SKETCH = ViewSketch,
        // MESH = ViewMesh,
    })(VIEW = Fudge.VIEW || (Fudge.VIEW = {}));
    let TRANSFORM;
    (function (TRANSFORM) {
        TRANSFORM["NONE"] = "none";
        TRANSFORM["TRANSLATE"] = "translate";
        TRANSFORM["ROTATE"] = "rotate";
        TRANSFORM["SCALE"] = "scale";
        TRANSFORM["WORLD"] = "world";
        TRANSFORM["LOCAL"] = "local";
    })(TRANSFORM = Fudge.TRANSFORM || (Fudge.TRANSFORM = {}));
})(Fudge || (Fudge = {}));
///<reference types="../../node_modules/electron"/>
/**
 * Main electron application running node. Starts the browser window to contain Fudge and sets up the main menu.
 * See subfolder Fudge for most of the other functionality
 */
var Main;
///<reference types="../../node_modules/electron"/>
/**
 * Main electron application running node. Starts the browser window to contain Fudge and sets up the main menu.
 * See subfolder Fudge for most of the other functionality
 */
(function (Main) {
    //#region Types and Data
    // eslint-disable-next-line @typescript-eslint/naming-convention
    const { app, BrowserWindow, Menu, ipcMain } = require("electron");
    const { join } = require("path");
    // couldn't find type in electron d.ts file
    const remote = require("@electron/remote/main");
    remote.initialize();
    let fudge;
    let defaultWidth = 800;
    let defaultHeight = 600;
    let saved = false;
    //#endregion
    // app.commandLine.appendSwitch("autoplay-policy", "no-user-gesture-required");
    //#region Events 
    app.addListener("ready", createFudge);
    app.addListener("activate", function () {
        console.log("Activate");
        if (fudge === null)
            createFudge();
    });
    ipcMain.addListener("enableMenuItem", function (_event, _args) {
        Menu.getApplicationMenu().getMenuItemById(_args["item"]).enabled = _args["on"];
    });
    function quit(_event) {
        if (!saved) {
            if ("type" in _event)
                console.log("Trying to save state!", _event.type);
            // _event.preventDefault();
            send(fudge, Fudge.MENU.QUIT);
            saved = true;
            if (process.platform !== "darwin")
                app.quit();
        }
    }
    function send(_window, _message, ..._args) {
        console.log(`Send message ${_message}`);
        _window.webContents.send(_message, _args);
    }
    //#endregion
    //#region Window
    function createFudge() {
        console.log("createFudge");
        fudge = addWindow("../Html/Fudge.html");
        const menu = Menu.buildFromTemplate(getMenuFudge());
        // fudge.setMenu(menu);
        Menu.setApplicationMenu(menu);
        fudge.on("close", quit);
    }
    function addWindow(_url, _width = defaultWidth, _height = defaultHeight) {
        let window = new BrowserWindow({
            width: _width,
            height: _height,
            icon: join(__dirname, "../Html/Image/Logo64.png"),
            // fullscreen: true,
            webPreferences: {
                nodeIntegration: true,
                contextIsolation: false
            }
        });
        remote.enable(window.webContents);
        window.webContents.openDevTools();
        window.loadFile(_url);
        window.maximize();
        return window;
    }
    // #endregion
    //#region Menus  
    function menuSelect(_item, _window, _event) {
        console.log(`MenuSelect: Item-id=${Fudge.MENU[_item.id]}`);
        // TODO: simplify switch using enums as messages
        switch (_item.id) {
            case Fudge.MENU.DEVTOOLS_OPEN:
                _window.webContents.openDevTools();
                break;
            case Fudge.MENU.FULLSCREEN:
                _window.fullScreen = !_window.isFullScreen();
                break;
            case Fudge.MENU.QUIT:
                quit({ type: "Ctrl+Q" });
                break;
            default:
                send(_window, _item.id, null);
                break;
        }
    }
    function getMenuFudge() {
        const menu = [
            {
                label: "Project", submenu: [
                    { label: "New", id: Fudge.MENU.PROJECT_NEW, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+N" : "Ctrl+N" },
                    { label: "Load", id: Fudge.MENU.PROJECT_LOAD, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+L" : "Ctrl+L" },
                    { label: "Save", id: Fudge.MENU.PROJECT_SAVE, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+S" : "Ctrl+S", enabled: false },
                    { label: "Quit", id: Fudge.MENU.QUIT, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+Q" : "Ctrl+Q" }
                ]
            },
            {
                label: "Panel", submenu: [
                    { label: "Help", id: Fudge.MENU.PANEL_HELP_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+H" : "Ctrl+H", enabled: true },
                    { label: "Project", id: Fudge.MENU.PANEL_PROJECT_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+R" : "Ctrl+R", enabled: false },
                    { label: "Graph", id: Fudge.MENU.PANEL_GRAPH_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+G" : "Ctrl+G", enabled: false },
                    { label: "Animation", id: Fudge.MENU.PANEL_ANIMATION_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+I" : "Ctrl+I", enabled: false },
                    { label: "Particle System", id: Fudge.MENU.PANEL_PARTICLE_SYSTEM_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "" : "", enabled: false }
                ]
            },
            {
                label: "Debug", submenu: [
                    { label: "DevTool", id: Fudge.MENU.DEVTOOLS_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "F12" : "F12" },
                    { label: "Fullscreen", id: Fudge.MENU.FULLSCREEN, click: menuSelect, accelerator: process.platform == "darwin" ? "F11" : "F11" }
                ]
            }
        ];
        return menu;
    }
    // #endregion
})(Main || (Main = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL1NvdXJjZS9GdWRnZS9EZWZpbml0aW9uLnRzIiwiLi4vU291cmNlL01haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBVSxLQUFLLENBcUZkO0FBckZELFdBQVUsS0FBSztJQUNiLElBQVksV0FnQ1g7SUFoQ0QsV0FBWSxXQUFXO1FBQ3JCLHVCQUF1QjtRQUN2QixxREFBUSxDQUFBO1FBQ1IsK0RBQWEsQ0FBQTtRQUNiLDJEQUFXLENBQUE7UUFDWCwrREFBYSxDQUFBO1FBQ2IscUVBQWdCLENBQUE7UUFDaEIsNkVBQW9CLENBQUE7UUFDcEIsNkNBQUksQ0FBQTtRQUNKLCtEQUFhLENBQUE7UUFDYiwyREFBVyxDQUFBO1FBQ1gsbUVBQWUsQ0FBQTtRQUNmLDhEQUFZLENBQUE7UUFDWixzRUFBZ0IsQ0FBQTtRQUNoQixrRkFBc0IsQ0FBQTtRQUN0QixrRUFBYyxDQUFBO1FBQ2Qsc0VBQWdCLENBQUE7UUFDaEIsd0RBQVMsQ0FBQTtRQUNULG9FQUFlLENBQUE7UUFDZixrRUFBYyxDQUFBO1FBQ2QsMEVBQWtCLENBQUE7UUFDbEIsNEVBQW1CLENBQUE7UUFDbkIsd0VBQWlCLENBQUE7UUFDakIsOERBQVksQ0FBQTtRQUNaLG9FQUFlLENBQUE7UUFDZix3RUFBaUIsQ0FBQTtRQUNqQixnRkFBcUIsQ0FBQTtRQUNyQixnRkFBcUIsQ0FBQTtRQUNyQixnRkFBcUIsQ0FBQTtRQUNyQix3RUFBaUIsQ0FBQTtRQUNqQiw0RkFBMkIsQ0FBQTtRQUMzQiw4RUFBb0IsQ0FBQTtJQUN0QixDQUFDLEVBaENXLFdBQVcsR0FBWCxpQkFBVyxLQUFYLGlCQUFXLFFBZ0N0QjtJQUdELElBQVksSUFZWDtJQVpELFdBQVksSUFBSTtRQUNkLHFCQUFhLENBQUE7UUFDYixrQ0FBMEIsQ0FBQTtRQUMxQixvQ0FBNEIsQ0FBQTtRQUM1QixvQ0FBNEIsQ0FBQTtRQUM1QixzQ0FBOEIsQ0FBQTtRQUM5Qiwy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Q0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUU7aUJBQ2hLO2FBQ0Y7WUFDRDtnQkFDRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtvQkFDdkIsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxPQUFPLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUU7b0JBQ2hJLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsT0FBTyxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFO2lCQUNqSTthQUNGO1NBQUMsQ0FBQztRQUNMLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUNELGFBQWE7QUFDZixDQUFDLEVBaElTLElBQUksS0FBSixJQUFJLFFBZ0liIiwic291cmNlc0NvbnRlbnQiOlsibmFtZXNwYWNlIEZ1ZGdlIHtcclxuICBleHBvcnQgZW51bSBDT05URVhUTUVOVSB7XHJcbiAgICAvLyBTS0VUQ0ggPSBWaWV3U2tldGNoLFxyXG4gICAgQUREX05PREUsXHJcbiAgICBBQ1RJVkFURV9OT0RFLFxyXG4gICAgREVMRVRFX05PREUsXHJcbiAgICBBRERfQ09NUE9ORU5ULFxyXG4gICAgREVMRVRFX0NPTVBPTkVOVCxcclxuICAgIEFERF9DT01QT05FTlRfU0NSSVBULFxyXG4gICAgRURJVCxcclxuICAgIENSRUFURV9GT0xERVIsXHJcbiAgICBDUkVBVEVfTUVTSCxcclxuICAgIENSRUFURV9NQVRFUklBTCxcclxuICAgIENSRUFURV9HUkFQSCxcclxuICAgIENSRUFURV9BTklNQVRJT04sXHJcbiAgICBDUkVBVEVfUEFSVElDTEVfRUZGRUNULFxyXG4gICAgU1lOQ19JTlNUQU5DRVMsXHJcbiAgICBSRU1PVkVfQ09NUE9ORU5ULFxyXG4gICAgQUREX0pPSU5ULFxyXG4gICAgREVMRVRFX1JFU09VUkNFLFxyXG4gICAgQ0xPTkVfUkVTT1VSQ0UsXHJcbiAgICBPUlRIR1JBUEhJQ19DQU1FUkEsXHJcbiAgICBSRU5ERVJfQ09OVElOVU9VU0xZLFxyXG4gICAgU0VMRUNUSU9OX09VVExJTkUsXHJcbiAgICBBRERfUFJPUEVSVFksXHJcbiAgICBERUxFVEVfUFJPUEVSVFksXHJcbiAgICBDT05WRVJUX0FOSU1BVElPTixcclxuICAgIEFERF9QQVJUSUNMRV9QUk9QRVJUWSxcclxuICAgIEFERF9QQVJUSUNMRV9GVU5DVElPTixcclxuICAgIEFERF9QQVJUSUNMRV9DT05TVEFOVCxcclxuICAgIEFERF9QQVJUSUNMRV9DT0RFLFxyXG4gICAgQUREX1BBUlRJQ0xFX1RSQU5TRk9STUFUSU9OLFxyXG4gICAgREVMRVRFX1BBUlRJQ0xFX0RBVEFcclxuICB9XHJcblxyXG5cclxuICBleHBvcnQgZW51bSBNRU5VIHtcclxuICAgIFFVSVQgPSBcInF1aXRcIixcclxuICAgIFBST0pFQ1RfTkVXID0gXCJwcm9qZWN0TmV3XCIsXHJcbiAgICBQUk9KRUNUX1NBVkUgPSBcInByb2plY3RTYXZlXCIsXHJcbiAgICBQUk9KRUNUX0xPQUQgPSBcInByb2plY3RMb2FkXCIsXHJcbiAgICBERVZUT09MU19PUEVOID0gXCJkZXZ0b29sc09wZW5cIixcclxuICAgIFBBTkVMX0dSQVBIX09QRU4gPSBcInBhbmVsR3JhcGhPcGVuXCIsXHJcbiAgICBQQU5FTF9BTklNQVRJT05fT1BFTiA9IFwicGFuZWxBbmltYXRpb25PcGVuXCIsXHJcbiAgICBQQU5FTF9QUk9KRUNUX09QRU4gPSBcInBhbmVsUHJvamVjdE9wZW5cIixcclxuICAgIFBBTkVMX0hFTFBfT1BFTiA9IFwicGFuZWxIZWxwT3BlblwiLFxyXG4gICAgUEFORUxfUEFSVElDTEVfU1lTVEVNX09QRU4gPSBcInBhbmVsUGFydGljbGVTeXN0ZW1PcGVuXCIsXHJcbiAgICBGVUxMU0NSRUVOID0gXCJmdWxsc2NyZWVuXCJcclxuICB9XHJcblxyXG4gIGV4cG9ydCBlbnVtIFBBTkVMIHtcclxuICAgIEdSQVBIID0gXCJQYW5lbEdyYXBoXCIsXHJcbiAgICBQUk9KRUNUID0gXCJQYW5lbFByb2plY3RcIixcclxuICAgIEhFTFAgPSBcIlBhbmVsSGVscFwiLFxyXG4gICAgQU5JTUFUSU9OID0gXCJQYW5lbEFuaW1hdGlvblwiLFxyXG4gICAgUEFSVElDTEVfU1lTVEVNID0gXCJQYW5lbFBhcnRpY2xlU3lzdGVtXCJcclxuXHJcbiAgfVxyXG5cclxuICBleHBvcnQgZW51bSBWSUVXIHtcclxuICAgIEhJRVJBUkNIWSA9IFwiVmlld0hpZXJhcmNoeVwiLFxyXG4gICAgQU5JTUFUSU9OID0gXCJWaWV3QW5pbWF0aW9uXCIsXHJcbiAgICBBTklNQVRJT05fU0hFRVQgPSBcIlZpZXdBbmltYXRpb25TaGVldFwiLFxyXG4gICAgUkVOREVSID0gXCJWaWV3UmVuZGVyXCIsXHJcbiAgICBDT01QT05FTlRTID0gXCJWaWV3Q29tcG9uZW50c1wiLFxyXG4gICAgQ0FNRVJBID0gXCJWaWV3Q2FtZXJhXCIsXHJcbiAgICBJTlRFUk5BTF9UQUJMRSA9IFwiVmlld0ludGVybmFsVGFibGVcIixcclxuICAgIElOVEVSTkFMX0ZPTERFUiA9IFwiVmlld0ludGVybmFsRm9sZGVyXCIsXHJcbiAgICBFWFRFUk5BTCA9IFwiVmlld0V4dGVybmFsXCIsXHJcbiAgICBQUk9QRVJUSUVTID0gXCJWaWV3UHJvcGVydGllc1wiLFxyXG4gICAgUFJFVklFVyA9IFwiVmlld1ByZXZpZXdcIixcclxuICAgIFNDUklQVCA9IFwiVmlld1NjcmlwdFwiLFxyXG4gICAgUEFSVElDTEVfU1lTVEVNID0gXCJWaWV3UGFydGljbGVTeXN0ZW1cIlxyXG4gICAgLy8gU0tFVENIID0gVmlld1NrZXRjaCxcclxuICAgIC8vIE1FU0ggPSBWaWV3TWVzaCxcclxuICB9XHJcblxyXG4gIGV4cG9ydCBlbnVtIFRSQU5TRk9STSB7XHJcbiAgICBOT05FID0gXCJub25lXCIsXHJcbiAgICBUUkFOU0xBVEUgPSBcInRyYW5zbGF0ZVwiLFxyXG4gICAgUk9UQVRFID0gXCJyb3RhdGVcIixcclxuICAgIFNDQUxFID0gXCJzY2FsZVwiLFxyXG4gICAgV09STEQgPSBcIndvcmxkXCIsXHJcbiAgICBMT0NBTCA9IFwibG9jYWxcIlxyXG4gIH1cclxufSIsIi8vLzxyZWZlcmVuY2UgdHlwZXM9XCIuLi8uLi9ub2RlX21vZHVsZXMvZWxlY3Ryb25cIi8+XHJcblxyXG4vKipcclxuICogTWFpbiBlbGVjdHJvbiBhcHBsaWNhdGlvbiBydW5uaW5nIG5vZGUuIFN0YXJ0cyB0aGUgYnJvd3NlciB3aW5kb3cgdG8gY29udGFpbiBGdWRnZSBhbmQgc2V0cyB1cCB0aGUgbWFpbiBtZW51LlxyXG4gKiBTZWUgc3ViZm9sZGVyIEZ1ZGdlIGZvciBtb3N0IG9mIHRoZSBvdGhlciBmdW5jdGlvbmFsaXR5XHJcbiAqL1xyXG5uYW1lc3BhY2UgTWFpbiB7XHJcbiAgLy8jcmVnaW9uIFR5cGVzIGFuZCBEYXRhXHJcblxyXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbmFtaW5nLWNvbnZlbnRpb25cclxuICBjb25zdCB7IGFwcCwgQnJvd3NlcldpbmRvdywgTWVudSwgaXBjTWFpbiB9ID0gcmVxdWlyZShcImVsZWN0cm9uXCIpO1xyXG4gIGNvbnN0IHsgam9pbiB9ID0gPHR5cGVvZiBpbXBvcnQoXCJwYXRoXCIpPnJlcXVpcmUoXCJwYXRoXCIpO1xyXG5cclxuICAvLyBjb3VsZG4ndCBmaW5kIHR5cGUgaW4gZWxlY3Ryb24gZC50cyBmaWxlXHJcbiAgY29uc3QgcmVtb3RlOiB7IGluaXRpYWxpemU6ICgpID0+IHZvaWQ7IGVuYWJsZTogKGNvbnRlbnRzOiBFbGVjdHJvbi5XZWJDb250ZW50cykgPT4gdm9pZCB9ID0gcmVxdWlyZShcIkBlbGVjdHJvbi9yZW1vdGUvbWFpblwiKTtcclxuXHJcbiAgcmVtb3RlLmluaXRpYWxpemUoKTtcclxuXHJcbiAgbGV0IGZ1ZGdlOiBFbGVjdHJvbi5Ccm93c2VyV2luZG93O1xyXG4gIGxldCBkZWZhdWx0V2lkdGg6IG51bWJlciA9IDgwMDtcclxuICBsZXQgZGVmYXVsdEhlaWdodDogbnVtYmVyID0gNjAwO1xyXG4gIGxldCBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIC8vI2VuZHJlZ2lvblxyXG5cclxuICAvLyBhcHAuY29tbWFuZExpbmUuYXBwZW5kU3dpdGNoKFwiYXV0b3BsYXktcG9saWN5XCIsIFwibm8tdXNlci1nZXN0dXJlLXJlcXVpcmVkXCIpO1xyXG5cclxuICAvLyNyZWdpb24gRXZlbnRzIFxyXG4gIGFwcC5hZGRMaXN0ZW5lcihcInJlYWR5XCIsIGNyZWF0ZUZ1ZGdlKTtcclxuICBhcHAuYWRkTGlzdGVuZXIoXCJhY3RpdmF0ZVwiLCBmdW5jdGlvbiAoKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFjdGl2YXRlXCIpO1xyXG4gICAgaWYgKGZ1ZGdlID09PSBudWxsKSBjcmVhdGVGdWRnZSgpO1xyXG4gIH0pO1xyXG5cclxuICBpcGNNYWluLmFkZExpc3RlbmVyKFwiZW5hYmxlTWVudUl0ZW1cIiwgZnVuY3Rpb24gKF9ldmVudDogRWxlY3Ryb24uRXZlbnQsIF9hcmdzOiBPYmplY3QpOiB2b2lkIHtcclxuICAgIE1lbnUuZ2V0QXBwbGljYXRpb25NZW51KCkuZ2V0TWVudUl0ZW1CeUlkKF9hcmdzW1wiaXRlbVwiXSkuZW5hYmxlZCA9IF9hcmdzW1wib25cIl07XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHF1aXQoX2V2ZW50OiBFbGVjdHJvbi5FdmVudCB8IHsgdHlwZTogc3RyaW5nIH0pOiB2b2lkIHtcclxuICAgIGlmICghc2F2ZWQpIHtcclxuICAgICAgaWYgKFwidHlwZVwiIGluIF9ldmVudClcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlRyeWluZyB0byBzYXZlIHN0YXRlIVwiLCBfZXZlbnQudHlwZSk7XHJcbiAgICAgIC8vIF9ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBzZW5kKGZ1ZGdlLCBGdWRnZS5NRU5VLlFVSVQpO1xyXG4gICAgICBzYXZlZCA9IHRydWU7XHJcbiAgICAgIGlmIChwcm9jZXNzLnBsYXRmb3JtICE9PSBcImRhcndpblwiKVxyXG4gICAgICAgIGFwcC5xdWl0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzZW5kKF93aW5kb3c6IEVsZWN0cm9uLkJyb3dzZXJXaW5kb3csIF9tZXNzYWdlOiBzdHJpbmcsIC4uLl9hcmdzOiB1bmtub3duW10pOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKGBTZW5kIG1lc3NhZ2UgJHtfbWVzc2FnZX1gKTtcclxuICAgIF93aW5kb3cud2ViQ29udGVudHMuc2VuZChfbWVzc2FnZSwgX2FyZ3MpO1xyXG4gIH1cclxuICAvLyNlbmRyZWdpb25cclxuXHJcbiAgLy8jcmVnaW9uIFdpbmRvd1xyXG4gIGZ1bmN0aW9uIGNyZWF0ZUZ1ZGdlKCk6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coXCJjcmVhdGVGdWRnZVwiKTtcclxuICAgIGZ1ZGdlID0gYWRkV2luZG93KFwiLi4vSHRtbC9GdWRnZS5odG1sXCIpO1xyXG4gICAgY29uc3QgbWVudTogRWxlY3Ryb24uTWVudSA9IE1lbnUuYnVpbGRGcm9tVGVtcGxhdGUoZ2V0TWVudUZ1ZGdlKCkpO1xyXG4gICAgLy8gZnVkZ2Uuc2V0TWVudShtZW51KTtcclxuICAgIE1lbnUuc2V0QXBwbGljYXRpb25NZW51KG1lbnUpO1xyXG4gICAgZnVkZ2Uub24oXCJjbG9zZVwiLCBxdWl0KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZFdpbmRvdyhfdXJsOiBzdHJpbmcsIF93aWR0aDogbnVtYmVyID0gZGVmYXVsdFdpZHRoLCBfaGVpZ2h0OiBudW1iZXIgPSBkZWZhdWx0SGVpZ2h0KTogRWxlY3Ryb24uQnJvd3NlcldpbmRvdyB7XHJcbiAgICBsZXQgd2luZG93OiBFbGVjdHJvbi5Ccm93c2VyV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coe1xyXG4gICAgICB3aWR0aDogX3dpZHRoLFxyXG4gICAgICBoZWlnaHQ6IF9oZWlnaHQsXHJcbiAgICAgIGljb246IGpvaW4oX19kaXJuYW1lLCBcIi4uL0h0bWwvSW1hZ2UvTG9nbzY0LnBuZ1wiKSxcclxuICAgICAgLy8gZnVsbHNjcmVlbjogdHJ1ZSxcclxuICAgICAgd2ViUHJlZmVyZW5jZXM6IHsgICAgICAgIC8vIHByZWxvYWQ6IHBhdGguam9pbihfX2Rpcm5hbWUsIFwicHJlbG9hZC5qc1wiKSxcclxuICAgICAgICBub2RlSW50ZWdyYXRpb246IHRydWUsXHJcbiAgICAgICAgY29udGV4dElzb2xhdGlvbjogZmFsc2VcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVtb3RlLmVuYWJsZSh3aW5kb3cud2ViQ29udGVudHMpO1xyXG5cclxuICAgIHdpbmRvdy53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcclxuICAgIHdpbmRvdy5sb2FkRmlsZShfdXJsKTtcclxuICAgIHdpbmRvdy5tYXhpbWl6ZSgpO1xyXG4gICAgcmV0dXJuIHdpbmRvdztcclxuICB9XHJcbiAgLy8gI2VuZHJlZ2lvblxyXG5cclxuICAvLyNyZWdpb24gTWVudXMgIFxyXG4gIGZ1bmN0aW9uIG1lbnVTZWxlY3QoX2l0ZW06IEVsZWN0cm9uLk1lbnVJdGVtLCBfd2luZG93OiBFbGVjdHJvbi5Ccm93c2VyV2luZG93LCBfZXZlbnQ6IEVsZWN0cm9uLktleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKGBNZW51U2VsZWN0OiBJdGVtLWlkPSR7RnVkZ2UuTUVOVVtfaXRlbS5pZF19YCk7XHJcbiAgICAvLyBUT0RPOiBzaW1wbGlmeSBzd2l0Y2ggdXNpbmcgZW51bXMgYXMgbWVzc2FnZXNcclxuICAgIHN3aXRjaCAoX2l0ZW0uaWQpIHtcclxuICAgICAgY2FzZSBGdWRnZS5NRU5VLkRFVlRPT0xTX09QRU46XHJcbiAgICAgICAgX3dpbmRvdy53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBGdWRnZS5NRU5VLkZVTExTQ1JFRU46XHJcbiAgICAgICAgX3dpbmRvdy5mdWxsU2NyZWVuID0gIV93aW5kb3cuaXNGdWxsU2NyZWVuKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgRnVkZ2UuTUVOVS5RVUlUOlxyXG4gICAgICAgIHF1aXQoeyB0eXBlOiBcIkN0cmwrUVwiIH0pO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHNlbmQoX3dpbmRvdywgX2l0ZW0uaWQsIG51bGwpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0TWVudUZ1ZGdlKCk6IEVsZWN0cm9uLk1lbnVJdGVtQ29uc3RydWN0b3JPcHRpb25zW10ge1xyXG4gICAgY29uc3QgbWVudTogRWxlY3Ryb24uTWVudUl0ZW1Db25zdHJ1Y3Rvck9wdGlvbnNbXSA9IFtcclxuICAgICAge1xyXG4gICAgICAgIGxhYmVsOiBcIlByb2plY3RcIiwgc3VibWVudTogW1xyXG4gICAgICAgICAgeyBsYWJlbDogXCJOZXdcIiwgaWQ6IEZ1ZGdlLk1FTlUuUFJPSkVDVF9ORVcsIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK05cIiA6IFwiQ3RybCtOXCIgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiTG9hZFwiLCBpZDogRnVkZ2UuTUVOVS5QUk9KRUNUX0xPQUQsIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK0xcIiA6IFwiQ3RybCtMXCIgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiU2F2ZVwiLCBpZDogRnVkZ2UuTUVOVS5QUk9KRUNUX1NBVkUsIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK1NcIiA6IFwiQ3RybCtTXCIsIGVuYWJsZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIlF1aXRcIiwgaWQ6IEZ1ZGdlLk1FTlUuUVVJVCwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkNvbW1hbmQrUVwiIDogXCJDdHJsK1FcIiB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbGFiZWw6IFwiUGFuZWxcIiwgc3VibWVudTogW1xyXG4gICAgICAgICAgeyBsYWJlbDogXCJIZWxwXCIsIGlkOiBGdWRnZS5NRU5VLlBBTkVMX0hFTFBfT1BFTiwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkNvbW1hbmQrSFwiIDogXCJDdHJsK0hcIiwgZW5hYmxlZDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBsYWJlbDogXCJQcm9qZWN0XCIsIGlkOiBGdWRnZS5NRU5VLlBBTkVMX1BST0pFQ1RfT1BFTiwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkNvbW1hbmQrUlwiIDogXCJDdHJsK1JcIiwgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiR3JhcGhcIiwgaWQ6IEZ1ZGdlLk1FTlUuUEFORUxfR1JBUEhfT1BFTiwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkNvbW1hbmQrR1wiIDogXCJDdHJsK0dcIiwgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiQW5pbWF0aW9uXCIsIGlkOiBGdWRnZS5NRU5VLlBBTkVMX0FOSU1BVElPTl9PUEVOLCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiQ29tbWFuZCtJXCIgOiBcIkN0cmwrSVwiLCBlbmFibGVkOiBmYWxzZSB9LFxyXG4gICAgICAgICAgeyBsYWJlbDogXCJQYXJ0aWNsZSBTeXN0ZW1cIiwgaWQ6IEZ1ZGdlLk1FTlUuUEFORUxfUEFSVElDTEVfU1lTVEVNX09QRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJcIiA6IFwiXCIsIGVuYWJsZWQ6IGZhbHNlIH1cclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBsYWJlbDogXCJEZWJ1Z1wiLCBzdWJtZW51OiBbXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIkRldlRvb2xcIiwgaWQ6IEZ1ZGdlLk1FTlUuREVWVE9PTFNfT1BFTiwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkYxMlwiIDogXCJGMTJcIiB9LFxyXG4gICAgICAgICAgeyBsYWJlbDogXCJGdWxsc2NyZWVuXCIsIGlkOiBGdWRnZS5NRU5VLkZVTExTQ1JFRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJGMTFcIiA6IFwiRjExXCIgfVxyXG4gICAgICAgIF1cclxuICAgICAgfV07XHJcbiAgICByZXR1cm4gbWVudTtcclxuICB9XHJcbiAgLy8gI2VuZHJlZ2lvblxyXG59XHJcbiJdfQ==